{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '47428851-5b047435bdffa798507e52955';\n\nexport async function fetchImages(query, page = 1, perPage = 15) {\n  const response = await axios.get(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n\n  return response.data;\n}\n","// export function renderGallery(images) {\n//   return images\n//     .map(\n//       ({ webformatURL, largeImageURL, tags }) => `\n//     <li>\n//       <a href=\"${largeImageURL}\">\n//         <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n//       </a>\n//     </li>`\n//     )\n//     .join('');\n// }\nexport function renderGallery(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <li>\n          <a href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          </a>\n          <div class=\"gallery-item-info\">\n            <span>Likes: ${likes}</span>\n            <span>Views: ${views}</span>\n            <span>Comments: ${comments}</span>\n            <span>Downloads: ${downloads}</span>\n          </div>\n        </li>`\n    )\n    .join('');\n}\n","import { fetchImages } from './js/pixabay-api';\nimport { renderGallery } from './js/render-functions';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('#load-more');\nconst loader = document.querySelector('.loader');\n\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\nlet lightbox;\n\nform.addEventListener('submit', handleSearch);\nloadMoreButton.addEventListener('click', loadMoreImages);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  query = event.currentTarget.searchQuery.value.trim();\n\n  if (!query) {\n    iziToast.warning({ message: 'Please enter a search query!' });\n    return;\n  }\n\n  page = 1;\n  gallery.innerHTML = '';\n  toggleLoader(true);\n  loadMoreButton.classList.add('hidden');\n\n  try {\n    const { hits, totalHits: total } = await fetchImages(query, page);\n    totalHits = total;\n\n    if (hits.length === 0) {\n      iziToast.info({ message: 'No results found.' });\n      return;\n    }\n\n    gallery.innerHTML = renderGallery(hits);\n    initializeLightbox();\n\n    if (totalHits > hits.length) {\n      loadMoreButton.classList.remove('hidden');\n    }\n  } catch (error) {\n    iziToast.error({ message: 'Failed to fetch images. Try again later.' });\n  } finally {\n    toggleLoader(false);\n  }\n}\n\nasync function loadMoreImages() {\n  page += 1;\n  toggleLoader(true);\n\n  try {\n    const { hits } = await fetchImages(query, page);\n\n    gallery.insertAdjacentHTML('beforeend', renderGallery(hits));\n    refreshLightbox();\n    // scrollToNextBatch();\n\n    if (gallery.children.length >= totalHits) {\n      loadMoreButton.classList.add('hidden');\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({ message: 'Failed to load more images.' });\n  } finally {\n    toggleLoader(false);\n    scrollToNextBatch();\n  }\n}\n\nfunction toggleLoader(show) {\n  loader.classList.toggle('hidden', !show);\n}\n\nfunction initializeLightbox() {\n  lightbox = new SimpleLightbox('.gallery a');\n}\n\nfunction refreshLightbox() {\n  lightbox.refresh();\n}\n\nfunction scrollToNextBatch() {\n  const { height: cardHeight } =\n    gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["BASE_URL","API_KEY","fetchImages","query","page","perPage","axios","renderGallery","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","gallery","loadMoreButton","loader","totalHits","lightbox","handleSearch","loadMoreImages","event","iziToast","toggleLoader","hits","total","initializeLightbox","refreshLightbox","scrollToNextBatch","show","SimpleLightbox","cardHeight"],"mappings":"+vBAEA,MAAMA,EAAW,2BACXC,EAAU,qCAET,eAAeC,EAAYC,EAAOC,EAAO,EAAGC,EAAU,GAAI,CAa/D,OAZiB,MAAMC,EAAM,IAAIN,EAAU,CACzC,OAAQ,CACN,IAAKC,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAUC,CACX,CACL,CAAG,GAEe,IAClB,CCPO,SAASE,EAAcC,EAAQ,CACpC,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,qBAESL,CAAa;AAAA,wBACVD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,2BAGvBC,CAAK;AAAA,2BACLC,CAAK;AAAA,8BACFC,CAAQ;AAAA,+BACPC,CAAS;AAAA;AAAA,cAGnC,EACA,KAAK,EAAE,CACZ,CC9BA,MAAMC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAiB,SAAS,cAAc,YAAY,EACpDC,EAAS,SAAS,cAAc,SAAS,EAE/C,IAAIhB,EAAQ,GACRC,EAAO,EACPgB,EAAY,EACZC,EAEJL,EAAK,iBAAiB,SAAUM,CAAY,EAC5CJ,EAAe,iBAAiB,QAASK,CAAc,EAEvD,eAAeD,EAAaE,EAAO,CAIjC,GAHAA,EAAM,eAAc,EACpBrB,EAAQqB,EAAM,cAAc,YAAY,MAAM,KAAI,EAE9C,CAACrB,EAAO,CACVsB,EAAS,QAAQ,CAAE,QAAS,8BAAgC,CAAA,EAC5D,MACD,CAEDrB,EAAO,EACPa,EAAQ,UAAY,GACpBS,EAAa,EAAI,EACjBR,EAAe,UAAU,IAAI,QAAQ,EAErC,GAAI,CACF,KAAM,CAAE,KAAAS,EAAM,UAAWC,CAAK,EAAK,MAAM1B,EAAYC,EAAOC,CAAI,EAGhE,GAFAgB,EAAYQ,EAERD,EAAK,SAAW,EAAG,CACrBF,EAAS,KAAK,CAAE,QAAS,mBAAqB,CAAA,EAC9C,MACD,CAEDR,EAAQ,UAAYV,EAAcoB,CAAI,EACtCE,IAEIT,EAAYO,EAAK,QACnBT,EAAe,UAAU,OAAO,QAAQ,CAE3C,MAAe,CACdO,EAAS,MAAM,CAAE,QAAS,0CAA4C,CAAA,CAC1E,QAAY,CACRC,EAAa,EAAK,CACnB,CACH,CAEA,eAAeH,GAAiB,CAC9BnB,GAAQ,EACRsB,EAAa,EAAI,EAEjB,GAAI,CACF,KAAM,CAAE,KAAAC,CAAI,EAAK,MAAMzB,EAAYC,EAAOC,CAAI,EAE9Ca,EAAQ,mBAAmB,YAAaV,EAAcoB,CAAI,CAAC,EAC3DG,IAGIb,EAAQ,SAAS,QAAUG,IAC7BF,EAAe,UAAU,IAAI,QAAQ,EACrCO,EAAS,KAAK,CACZ,QAAS,4DACjB,CAAO,EAEJ,MAAe,CACdA,EAAS,MAAM,CAAE,QAAS,6BAA+B,CAAA,CAC7D,QAAY,CACRC,EAAa,EAAK,EAClBK,GACD,CACH,CAEA,SAASL,EAAaM,EAAM,CAC1Bb,EAAO,UAAU,OAAO,SAAU,CAACa,CAAI,CACzC,CAEA,SAASH,GAAqB,CAC5BR,EAAW,IAAIY,EAAe,YAAY,CAC5C,CAEA,SAASH,GAAkB,CACzBT,EAAS,QAAO,CAClB,CAEA,SAASU,GAAoB,CAC3B,KAAM,CAAE,OAAQG,CAAY,EAC1BjB,EAAQ,kBAAkB,wBAC5B,OAAO,SAAS,CACd,IAAKiB,EAAa,EAClB,SAAU,QACd,CAAG,CACH"}